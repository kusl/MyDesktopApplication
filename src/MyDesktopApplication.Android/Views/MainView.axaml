<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MyDesktopApplication.Shared.ViewModels"
             xmlns:conv="using:MyDesktopApplication.Android.Converters"
             x:Class="MyDesktopApplication.Android.Views.MainView"
             x:DataType="vm:CountryQuizViewModel">

    <UserControl.Resources>
        <conv:QuestionTypeLabelConverter x:Key="QuestionTypeLabelConverter"/>
        <conv:AnswerStateToBackgroundConverter x:Key="AnswerStateBgConverter"/>
        <conv:AnswerStateToForegroundConverter x:Key="AnswerStateFgConverter"/>
    </UserControl.Resources>

    <ScrollViewer>
        <StackPanel Margin="16" Spacing="12">
            
            <!-- Header with Score -->
            <Border Background="#1E3A5F" CornerRadius="12" Padding="16">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel>
                        <TextBlock Text="Country Quiz" 
                                   FontSize="24" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="{Binding AccuracyText}" 
                                   FontSize="14" Foreground="#B0C4DE"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                        <TextBlock Text="{Binding ScoreText}" 
                                   FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock Text="{Binding StreakText}" 
                                   FontSize="14" Foreground="#90EE90"/>
                        <TextBlock Text="{Binding BestStreakText}" 
                                   FontSize="12" Foreground="#FFD700"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Question Type Selector -->
            <Border Background="#2D4A6A" CornerRadius="8" Padding="12">
                <StackPanel>
                    <TextBlock Text="Category:" FontSize="14" Foreground="#B0C4DE" Margin="0,0,0,8"/>
                    <ComboBox ItemsSource="{Binding QuestionTypes}"
                              SelectedItem="{Binding SelectedQuestionType}"
                              HorizontalAlignment="Stretch"
                              MinHeight="48">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Converter={StaticResource QuestionTypeLabelConverter}}"
                                           FontSize="16"/>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>
            </Border>

            <!-- Question Text -->
            <TextBlock Text="{Binding QuestionText}"
                       FontSize="20" FontWeight="SemiBold"
                       TextAlignment="Center" TextWrapping="Wrap"
                       Foreground="White" Margin="0,8"/>

            <!-- Country Cards - Full Width for Easy Tapping -->
            <Button Command="{Binding SelectCountryCommand}"
                    CommandParameter="1"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    MinHeight="80"
                    Padding="0"
                    CornerRadius="12">
                <Button.Background>
                    <MultiBinding Converter="{StaticResource AnswerStateBgConverter}">
                        <Binding Path="IsCountry1Correct"/>
                        <Binding Path="IsCountry1Wrong"/>
                    </MultiBinding>
                </Button.Background>
                <Border Padding="16" HorizontalAlignment="Stretch">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <TextBlock Text="{Binding Country1Flag}" 
                                   FontSize="40" VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" Margin="16,0" VerticalAlignment="Center">
                            <TextBlock Text="{Binding Country1Name}" 
                                       FontSize="20" FontWeight="SemiBold">
                                <TextBlock.Foreground>
                                    <MultiBinding Converter="{StaticResource AnswerStateFgConverter}">
                                        <Binding Path="IsCountry1Correct"/>
                                        <Binding Path="IsCountry1Wrong"/>
                                    </MultiBinding>
                                </TextBlock.Foreground>
                            </TextBlock>
                            <TextBlock Text="{Binding Country1Value}"
                                       FontSize="14" Foreground="#B0C4DE"
                                       IsVisible="{Binding HasAnswered}"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2" Text="[1]" 
                                   FontSize="14" Foreground="#666"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </Button>

            <!-- VS Separator -->
            <TextBlock Text="VS" FontSize="16" FontWeight="Bold"
                       TextAlignment="Center" Foreground="#666"/>

            <Button Command="{Binding SelectCountryCommand}"
                    CommandParameter="2"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Stretch"
                    MinHeight="80"
                    Padding="0"
                    CornerRadius="12">
                <Button.Background>
                    <MultiBinding Converter="{StaticResource AnswerStateBgConverter}">
                        <Binding Path="IsCountry2Correct"/>
                        <Binding Path="IsCountry2Wrong"/>
                    </MultiBinding>
                </Button.Background>
                <Border Padding="16" HorizontalAlignment="Stretch">
                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <TextBlock Text="{Binding Country2Flag}" 
                                   FontSize="40" VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" Margin="16,0" VerticalAlignment="Center">
                            <TextBlock Text="{Binding Country2Name}" 
                                       FontSize="20" FontWeight="SemiBold">
                                <TextBlock.Foreground>
                                    <MultiBinding Converter="{StaticResource AnswerStateFgConverter}">
                                        <Binding Path="IsCountry2Correct"/>
                                        <Binding Path="IsCountry2Wrong"/>
                                    </MultiBinding>
                                </TextBlock.Foreground>
                            </TextBlock>
                            <TextBlock Text="{Binding Country2Value}"
                                       FontSize="14" Foreground="#B0C4DE"
                                       IsVisible="{Binding HasAnswered}"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2" Text="[2]" 
                                   FontSize="14" Foreground="#666"
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </Button>

            <!-- Result Message -->
            <TextBlock Text="{Binding ResultMessage}"
                       FontSize="18" FontWeight="SemiBold"
                       TextAlignment="Center"
                       Foreground="#90EE90"
                       IsVisible="{Binding HasAnswered}"
                       Margin="0,8"/>

            <!-- Next Round Button - NO EMOJIS -->
            <Button Content="Next Round"
                    Command="{Binding NextRoundCommand}"
                    IsVisible="{Binding HasAnswered}"
                    HorizontalAlignment="Stretch"
                    MinHeight="56"
                    FontSize="18"
                    FontWeight="SemiBold"
                    Background="#4CAF50"
                    Foreground="White"
                    CornerRadius="12"/>

            <!-- Reset Button -->
            <Button Content="Reset Game"
                    Command="{Binding ResetGameCommand}"
                    HorizontalAlignment="Stretch"
                    MinHeight="48"
                    FontSize="14"
                    Background="#666"
                    Foreground="White"
                    CornerRadius="8"
                    Margin="0,16,0,0"/>
                    
        </StackPanel>
    </ScrollViewer>
</UserControl>
